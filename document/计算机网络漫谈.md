# HttpRouter

`httprouter`内部通过实现一个trie树来提高性能。核心代码就是golang标准库中 http.Handler 接口，在该函数中实现自己的请求路由分发策略。

`net/http`不能单独的对请求方法(POST,GET等)注册特定的处理函数，不支持路由变量参数，不能自动对Path进行校准，性能一般、扩展性不足



## （Open System Interconnection Reference Model，缩写为OSI）
是一个试图使各种计算机在全世界范围内互联为网络的标准框架，它定义了网络互联的7层框架，也就是开放式系统互联参考模型。

![img](https:////upload-images.jianshu.io/upload_images/2179030-3694fe2b18ebe05f.png?imageMogr2/auto-orient/strip|imageView2/2/w/960/format/webp)


## 协议（protocol）
是一种双方都明白或者必须遵守的事先约定，比如说长城上放狼烟，是因为人们已经预先设定好狼烟这个物理信号代表了“敌人入侵”这一抽象信号。这样一个“狼烟=敌
人入侵”就是一个简单的协议。协议可以更复杂，比如摩尔斯码(Morse Code)，使用短信号和长信号的组合，来代表不同的英文字母。同样，计算机之间的通信也要遵
循不同层次的协议，来实现计算机的通信。早期的计算机网络，都是由各厂商自己规定一套协议，IBM，Apple，和MicroSoft都有自己的网络协议，比如MicroSoft
的两台电脑用网线连起来，互相说话能听懂。但是MicroSoft和Apple的电脑连接起来说话就听不懂了，想想你和我微信聊天，我是MicroSoft电脑，你是Apple电
脑，你发送的消息到我这里显示不了或者解析成另一个意思，这样通讯就不能进行了，为了把全世界的所有不同类型的计算机都连接起来，就必须规定一套全球通用的协
议，为了实现这个目标，"互联网协议簇"（Internet Protocol Suite）就成为了通用协议标准。互联网协议包含了上百种的协议，但是最重要的两个协议是TCP和IP
协议，而我们通常把基于TCP和IP协议的所有协议统称为”TCP/IP协议（蔟）”。

### 2.OSI七层模型是干什么的？

**互联网的实现，分成好几层，每一层都有自己的功能，就像建筑物一样，每一层都靠下一层支持**。我们在上图中已经大致标出了每一层的功能。OSI模型就是这样的
一个分层，它是一个由国际标准化组织􏰁提出的概念模型,试图提供一个**使各种不同计算机和网络在世界范围内实现互联的标准框架**。它将计算机网络体系结构划分
为七层，每层都可以提供抽象良好的接口。

### TCP/IP四层（参考）模型
TCP/IP和OSI模型组并不能精确的匹配，但是我们可以尽可能的参考OSI模型并在其中找到TCP/IP的对应位置。通常人们认为OSI模型最上面三层（应用层、表示层、
会话层）在TCP/IP中是一个应用层。由于TCP/IP有一个相对比较弱的会话层，由TCP和RTP下的打开和关闭连接组成，并在TCP/UDP下的各种应用提供不同的端口号，
这些功能被单个的应用程序添加。

### 4.TCP/IP（参考）模型与OSI七层模型有什么异同？
TCP/IP协议，是互联网协议（簇）的统称，是互联网标准通信的基础，它提供点对点的链接机制，将数据应该如何封装、定址、传输、路由以及在目的地如何接收，都
加以标准化。而OSI模型是开放式系统互联通信参考模型，是一个完整的、完善的宏观模型，它包括了硬件层（物理层），也包含了很多上面途中没有列出的协议(比如
DNS解析协议等)；而TCP/IP（参考）模型，更加侧重的是互联网通信核心（也是就是围绕TCP/IP协议展开的一系列通信协议）的分层，因此它不包括物理层，以及其
它一些不想干的协议；其次，之所以说他是参考模型，是因为他本身也是OSI模型中的一部分，因此参考OSI模型对其分层。


## 二.自底向上的网络分层
### 1、物理层
电脑要组网，第一件事要干什么？当然是先把电脑连起来，可以用光缆、电缆、双绞线、**无线电波（WiFi）**等方式。**物理层的作用就是通过物理手段把电脑连接
起来，它主要规定了网络的一些电气特性，作用是负责传送0和1的电信号。**这里说一下，通过**物理手段**将设备连接起来组网，物理手段就是光缆、电缆、双绞线、
**无线电波（WiFi）**等，比如中美之间的网络通信是通过海底光缆；两个不同的局域网（电信的网络和移动的网络）通讯，嗯，稍微麻烦点，我的电信手机先连上电
信的服务器，你的移动手机连移动服务器，他们两个ISP（Internet Service Provider 互联网服务提供商）之间是通过物理手段链接的，这样我们就能够间接的
实现通讯了。下图是2015年全球互联网跨国通信光缆的连接情况：

![img](https:////upload-images.jianshu.io/upload_images/2179030-8843cee62c30647c.png?imageMogr2/auto-orient/strip|imageView2/2/w/1059/format/webp)

2015年全球互联网跨国通信光缆的连接情况.png

可以看到，图中各个密密麻麻的线就是各个国家的链接情况，所以互联网可以说就是**用物理设备将各个“局域网”相连组成更大的“局域网“，更大局域网层层相连，
最终就组成了”互联网“**，比如小的互联网就是你家和我家的WiFi,一个省的每户家庭的WiFi组成这个省的局域网，各个省的局域网组成中国的局域网，各个国家之间
的局域网通过物理手段互联就组成了横跨世界的**”互联网“**（当然天朝还有一堵墙）。

## 2、数据链路层
物理层就是传输电路的0和1的信号，但是单纯的0和1没有意义，数据链路层确定了0和1的分组方式，使得每个分组的信号变得有意义；

### 以太网协议：
是一种电信号的分组方式的协议，"以太网"规定，一组电信号构成一个数据包，叫做"帧（Frame）"；每一帧分成两个个部分：标头（Head）和数据（Data）。
“标头”包含数据包的一些说明项，比如发送者、接受者、数据类型等等。

### MAC地址：

MAC地址是以太网数据包的"标头"中发送者和接受者的标识；
- 以太网规定，连入网络的所有设备，都必须具有"网卡"接口。数据包必须是从一个网卡，传送到另一个网卡，网卡的地址，就是数据包的发送地址和接受地址，也叫MAC地址。
- 每块网卡出厂的时候，都有全世界独一无二的MAC地址，长度是48位的二进制，通常用12个十六进制数表示，前6个十六进制是厂商编号，后6个是该厂商的网卡流水号。

### 3、网络层

根据上面的讲解，理论上依靠MAC地址和广播技术，上海的网卡发出的数据包就可以找到洛杉矶网卡了——但是如果全世界的计算机都这么干，那么每一台计算机发出的
数据包都同步广播到全世界其他电脑，再一一比对判断，这样显然是低效、不现实的。
因此，上面我们强调，广播是在发送者所在的局域网内广播的，不同也就是说，如果两台计算机没有在同一个子网（局域网）内，是无法通过广播直接传过去的。前面我
们说过，互联网是由一个个子网组成的更大的子网，一级一级组网，最终构成的互联网。
因此我们必须找到一种方法，区分哪些MAC地址属于同一个子网。如果是同一个子网就采用广播的形式，如果不是，则采用“路由”的方式（后面会讲）发送——这就导致
了**网络层的出现，他的作用是引入一套新的地址，使我们能够区分哪些计算机属于同一个子网，这个套机制就叫做“网络地址”，也就是“IP地址”**。

### IP协议
IP地址目前有IPV4(Internet Protocol version 4，IPv4)和IPV6(Internet Protocol version 4，IPv6)两版，又称“互联网通信协议第四/六版”。
2011年，IANA IPv4 pool地址完全用尽时，IPv6仍处在部署的初期；
互联网上的每一台计算机，都会被分配到一个IP地址，这个地址由两部分组成，前部分的代表网络，后部分的代表主机；

路由：路由器连接两个或多个网络并提供路由功能。

网关：是在网络层上路由，即在网络层连节两个的子网的概念，并不存在实体，真正实现路由功能还是得靠路由器
路由器上面有MAC地址和MAC地址对应的IP，而网关由于是网络层的概念因此只有IP地址。在今天很多的局域网采用都是路由来接入网络，因此现在通常指的网关就是路由器的IP。
另外，需要强调一点，虽然路由器上面有MAC地址和IP地址，但它并不能通过MAC地址工作，必须通过IP寻址。因此它是工作在网络层的设备。


## ARP协议（介于数据链路层和网络层之间，ARP包需要包裹在一个帧中)
每一台主机和路由都能了解局域网内的IP地址和MAC地址的对应关系，这是实现IP包封装(encapsulation)到帧的基本条件。IP地址与MAC地址的对应是通过ARP协议
传播到局域网的每个主机和路由。每一台主机或路由中都有一个ARP cache，用以存储局域网内IP地址和MAC地址如何对应。

ARP协议的工作方式：主机发出包含有自己的IP地址和MAC地址的ARP包。通过ARP包，主机以广播的形式询问局域网上所有的主机和路由：我是IP地址####，我的MAC
地址是####，有人知道199.165.146.4的MAC地址吗？拥有该IP地址的主机会回复发出请求的主机：哦，我知道，这个IP地址属于我的一个NIC（网卡），它的MAC
地址是######。由于发送ARP请求的主机采取的是广播形式，并附带有自己的IP地址和MAC地址，其他的主机和路由会同时检查自己的ARP cache，如果不符合，则更
新自己的ARP cache。这样，经过几次ARP请求之后，ARP cache会达到稳定。如果局域网上设备发生变动，ARP重复上面过程。

ARP协议只用于IPv4。IPv6使用Neighbor Discovery Protocol来替代ARP的功能。

### 4.传输层
“传输层”的功能，就是建立“端口到端口”之间的通信。相比之下，“网络层”的功能是建立“主机到主机"的通信。只要确定主机和端口号，我们就能实现程序之间的交流。

### 5.应用层
应用程序收到"传输层"的数据，接下来就要进行解读。由于互联网是开放架构，数据来源五花八门，必须事先规定好格式，否则根本无法解读。**"应用层"的作用，就
是规定应用程序的数据格式。**举例说，TCP协议可以为各种各样的程序传递数据，比如Email、WWW、FTP等等。那么，必须有不同协议规定电子邮件、网页、FTP数
据的格式，这些应用程序协议就构成了"应用层"。这为最高的一层，直接面对用户。

这里的引用层是文章开头的OSI七层模型的最上面三层的综合，因为是直接面向用户，因此它的主要作用是**“消除设备固有数据格式和网络标准数据格式直接的差异”
**，因为在网络流中，数据的格式是标准化的，但是具体到不同得设备，不同的操作系统上，他的要求数据呈现格式不同的，因此需要转化成统一的、用户能够感知的
声音、图片、文字等信息，这就是应用层做的事情。


## 用户的上网设置
- **本机的IP地址**
- **子网掩码**
- **网关的IP地址**
- **DNS的IP地址**


根据上面的讲解，我们应该知道这四个参数的必要性，只有设置了这些我们才能上网。

#### ②.DNS解析

[网域名称系统（英文：Domain Name System，缩写：DNS）](https://link.jianshu.com?t=https://zh.wikipedia.org/wiki/域名系统)，端口53，
是互联网的一项服务。**它作为将域名和IP地址相互映射的一个分布式数据库，能够使人更方便地访问互联网**。
什么意思？我们上面已经说了，网络中的数据包，是通过**“端口号+IP地址+MAC地址”**来识别目的地址的，也就是说定位一个主机的时候，我们是定位的是他的IP地
址，然后我们通过浏览器访问的时候呢？比如我们要访问谷歌，就在浏览器中输入他的**"域名"：[www.google.com](https://link.jianshu.com?t=http://www.google.com)**，
却不是谷歌服务器的IP地址——这个时候，DNS协议就起作用了：
我们输入[www.google.com](https://link.jianshu.com?t=http://www.google.com)并按下回车的时候，本机服务器先是请求DNS服务器，DNS服务器
根据我们发送的域名，根据DNS协议，解析成该域名对应的IP地址并返回给本机，这样，我们就可以进行下面几层的地址封装了。

## 三.自顶向下的数据包结构

现在我们从一个用户的角度来自顶向下的过一遍，一个网络数据包的过程。首先我们设置了本机参数：

- **本机的IP地址：192.168.1.100**
- **子网掩码：255.255.255.0**
- **网关的IP地址：192.168.1.1**
- **DNS的IP地址：8.8.8.8**

打开浏览器访问谷歌的网址：[www.google.com](https://link.jianshu.com?t=http://www.google.com)，按下回车。这意味着，浏览器要向Google
发送一个网页请求的数据包。
第一步：主机会像DNS服务器发送请求，已知DNS服务器为8.8.8.8，于是我们向这个地址发送一个DNS数据包（53端口）；然后，DNS服务器做出响应，告诉我们Google的IP
地址是172.194.72.105。于是，我们知道了对方的IP地址。
第二步：接下来，我们要判断，这个IP地址是不是在同一个子网络，这就要用到子网掩码。已知子网掩码是255.255.255.0，本机用它对自己的IP地址192.168.1.100，做
一个二进制的AND运算（两个数位都为1，结果为1，否则为0），计算结果为192.168.1.0；然后对Google的IP地址172.194.72.105也做一个AND运算，计算结果
为172.194.72.0。这两个结果不相等，所以结论是，Google与本机不在同一个子网络。
第三步：因此，我们要向Google发送数据包，必须通过网关192.168.1.1转发，也就是说，接收方的MAC地址将是网关的MAC地址。至此发送的各种必要参数已经基本确定了，
数据包也可以发送了。

站在巨人的肩膀上摘苹果：
[互联网协议入门（一）阮一峰](https://link.jianshu.com?t=http://www.ruanyifeng.com/blog/2012/05/internet_protocol_suite_part_i.html)
[互联网协议入门（二）阮一峰](https://link.jianshu.com?t=http://www.ruanyifeng.com/blog/2012/06/internet_protocol_suite_part_ii.html)


【DHCP】(动态主机配置协议)，客户机登录服务器时就可以自动获得服务器分配的IP地址和子网掩码。
【ICMP】(internet控制报文协议)，是 TCP/IP 协议簇的一子协议，用于在IP主机、路由器之间传递控制消息(网络通不通、主机是否可达、路由是否可用)，这些
控制消息并不传输用户数据。
【交换机】工作于OSI参考模型的第二层，即数据链路层。交换机内部的CPU会在每个端口成功连接时，通过将MAC地址和端口对应，形成一张MAC表。在今后的通讯中，
发往该MAC地址的数据包将仅送往其对应的端口，而不是所有的端口。因此，交换机可用于划分数据链路层广播，即冲突域；但它不能划分网络层广播，即广播域。

【QoS（Quality of Service，服务质量）】
指一个网络能够利用各种基础技术，为指定的网络通信提供更好的服务能力，是网络的一种安全机制， 是用来解决网络延迟和阻塞等问题的一种技术。QoS的保证对于
容量有限的网络来说是十分重要的，特别是对于流多媒体应用，例如VoIP和IPTV等，因为这些应用常常需要固定的传输率，对延时也比较敏感。



# WebSocket 和 Socket 的区别
WebSocket是应用层协议，是应用层与TCP/IP协议族通信的中间软件抽象层，它是一组接口。WebSocket protocol 是HTML5一种新的协议。它实现了浏览器与
服务du器全双工通信(full-plex)。一开始的握手需要借助HTTP请求完成。
Socket是传输控制层协议，

WebSocket 和 Socket 的区别：https://zhidao.baidu.com/question/750010189618451132.html
TCP 重传、滑动窗口、流量控制、拥塞控制:https://www.jianshu.com/p/5b07a2f05771
网络编程之socket的运用：https://www.cnblogs.com/xuecaichang/p/9580448.html

电脑在生成数据包时是通过DNS获取对方电脑的IP地址的，并通过网管来进行数据包的传输，再通过各种路由协议将数据包传输到目的地；

TCP/IP 协议：https://www.jianshu.com/p/9f3e879a4c9c
HTTP 协议：https://www.jianshu.com/p/6e9e4156ece3：


## TCP第四次挥手等待2MSL【最长报文段寿命】
1、为了保证客户端发送的最后一个ACK报文段能够到达服务器。因为这个ACK有可能丢失，从而导致处在LAST-ACK状态的服务器收不到对FIN-ACK的确认报文。服务器
会超时重传这个FIN-ACK，接着客户端再重传一次确认，重新启动时间等待计时器。最后客户端和服务器都能正常的关闭。假设客户端不等待2MSL，而是在发送完ACK之
后直接释放关闭，一但这个ACK丢失的话，服务器就无法正常进入关闭连接状态。
2、客户端在发送最后一个ACK之后，经过2MSL，可以使本链接持续时间内所产生的所有报文段都从网络中消失，从保证在关闭连接后不会有还在网络中滞留的报文段去
骚扰服务器。



## JWT -- JSON WEB TOKEN
Json web token (JWT), 是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（(RFC 7519).该token被设计为紧凑且安全的，特别适用于分布
式站点的单点登录（SSO）场景。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外
的其它业务逻辑所必须的声明信息，该token也可直接被用于认证，也可被加密。

### 一、基于session认证:
1、通常而言session都是保存在内存中，而随着认证用户的增多，服务端的开销会明显增大
2、因为是基于cookie来进行用户识别的, cookie如果被截获，用户就会很容易受到跨站请求伪造的攻击。

### 二、基于token的鉴权机制：
基于token的鉴权机制类似于http协议也是无状态的，流程上是这样的：
1. 用户使用用户名密码来请求服务器
2. 服务器进行验证用户的信息
3. 服务器通过验证发送给用户一个token
4. 客户端存储token，并在每次请求时附送上这个token值
5. 服务端验证token值，并返回数据
token必须要在每次请求时传递给服务端，它应该保存在请求头里，另外，服务端要支持CORS（跨域资源共享）策略


## make 和 makefile
`make`是一个命令工具，它解释`Makefile`中的指令。
`makefile`定义了一系列的规则来指定哪些文件需要先编译，哪些文件需要后编译，哪些文件需要重新编译，甚至于进行更复杂的功能操作，就像一个Shell脚本一样，
也可以执行操作系统的命令。在绝大多数的IDE开发环境中都在使用，已经成为一种工程的编译方法。

## JSON
是一种独立于语言的轻量级的数据交换格式，JSON的两种数据组成：
1、键值对的元素集合，对象(object)，对象是一个无序键值对的集合，以"{"开始，同时以"}"结束，键值对之间以":"相隔，不同的键值对之间以","相隔；
2、值的有序列表，数组(array)，数组是一有序集合的值，值(value)可以是一对括号括起来的字符串(string)、数值(number)、true、false、null、对象
(object)或者数组(array)。这些结构可以嵌套。字符串（string）是由双引号包围的任意数量Unicode字符的集合，使用反斜线转义。一个字符（character）
即一个单独的字符串（character string）


## API：
应用项目接口（Application Program Interface)，由请求和响应构成，提供一个软件到另一个的连接；

## `REST-ful`架构一种互联网软件架构模式，它结构清晰、符合标准、易于理解、扩展方便；、
1、使用一个URI代表一个网络上的资源实体，要获取这个资源（Resources），访问这个资源对应的URI就可以；
2、"资源"具体呈现出来的形式（文本txt格式、HTML、XML、JSON、二进制格式，图片JPG格式、PNG格式），它的具体表现形式，在HTTP请求的头信息中用 `Accept` 
和 `Content-Type` 字段指定，这两个字段才是对"表现层"（Representation）的描述。
3、客户端通过四个HTTP动词，对服务器端资源进行操作，实现"表现层状态转化（State Transfer）"。客户端和服务器的一个互动过程，涉及到的数据和状态的变化。

        
## HTTP methods：
get:获取、post:提交、put：更新、delete：删除；
head：不返回body的get、options：返回支持的http方法、patch:更新部分资源

## RPC（远程过程调用）
1、是一种封装了socket细节，通过网络从远程计算机上请求服务，RPC本身是client-server模型，也是一种request-response协议；常用于构建分布式应用（在
提供强大远程调用能力的同时不损失本地调用的语义简洁性），或用于公司内部的服务调用（性能消耗低，传输效率高，但实现比较复杂）;
2、核心功能：服务寻址；序列化和反序列化；网络传输（可以选择TCP协议、UDP协议、HTTP协议）；
3、RPC是建立在Socket之上的，它比socket需要更多的网络和系统资源

和RESTFulAPI(http)相比：
    (1)速度更快，原因是Tcp（传输层协议）是等于在http（应用层协议）的基础上做减法。
    (2)RPC可自定义报文，且自带负载均衡（http需要自己搞，比如nginx），可以基于tcp协议，也可基于http协议；
    (3)HTTP主要用于对外的异构环境，浏览器接口调用，App接口调用，第三方接口调用等。
   
开源框架：
    (1)gRPC：Google开源、通用的高性能RPC框架、基于的HTTP2.0协议（带来诸如双向流、流控、头部压缩、单TCP连接上的多复用请求等特。这些特性使得其在移动设备上表现更好，更省电和节省空间占用）、底层使用到了Netty框架的支持、基于ProtoBuf(Protocol Buffers)序列化协议开发；
    (2)Thrift：是Facebook的开源RPC框架，也是是一个跨语言的服务开发框架。用户只要在其之上进行二次开发就行，应用对于底层的RPC通讯等都是透明的。不过这个对于用户来说需要学习特定领域语言这个特性，还是有一定成本的。
    (3)Dubbo：是阿里集团开源的一个极为出名的RPC框架，在很多互联网公司和企业应用中广泛使用。协议和序列化框架都可以插拔是极其鲜明的特色。
    
    
### Jenkins
是一个开源软件项目，旨在提供一个开放易用的软件平台，使软件的持续集成变成可能。