## 缓存
	- 提高系统响应速度
	- 缓存是指代理服务器或客户端本地磁盘内保存的资源副本，利用缓存可减少对源服务器的访问，因此也就节省了通信流量和通信时间；（源服务器不必多次处理相同的请求了）	
## 一、关于缓存 ##
	缓存是高并发场景下提高热点数据 访问性能的一个有效手段，在开发项目时会经常使用到。
	 

 
什么是缓存，系统缓存有什么用：

在软件架构设计时，不但要注重可靠性、安全性、可扩展性以及可维护性等等的一些指标，更要注重用户的体验，用户体验分很多方面，但是有一点非常重要就是对用户操作的响应一定要快；说道提高服务的响应速度就必须提到缓存了；

从系统的层面说，CPU的速度远远高于磁盘IO的速度；所以要想提高响应速度，必须减少磁盘IO的操作，但是有很多信息又是存在数据库当中的，每次查询数据库就是一次IO操作；

现在多谈论的缓存是redis，其实常用的还有memcache等，它们都提供了集群模式，并且都是直接内存操作，所以速度特别快，也是目前业内使用的比较热门的技术；redis相对于memcache提供了更丰富的数据类型，根据不同的业务场景可以选在不同的数据类型；redis本身也提供了主从模式、集群模式；也有第三方的比如codis提供了redis集群解决方案；

总之一句话，要想提高系统的性能，尽量减少IO的操作，特别是磁盘IO的操作；使用缓存可以有效的避免这种情况；所以在架构设计过程中，社交到查询数据库的时候，应该考虑一下是不是考虑使用缓存技术来提高系统的性能，并且降低数据库的负载。



 
## 缓存系统的分类
	- CPU缓存（Cache Memory）**
		- 解决CPU运算速率与内存读写速率不匹配的矛盾，因为CPU运算速率要比内存读写速率快很多，这样会使CPU花费很长时间等待数据到来或把数据写入内存。而采用CPU缓存，当CPU调用大量数据时，就可避开内存直接从缓存中调用，从而加快读取速率。

	- 网络缓存：
		- Web应用的快速增长容易造成网络拥塞和服务器超载，导致客户访问延迟增大。而网络缓存技术被认为是减轻服务器负载、降低网络拥塞、增强Web可扩展性的有效途径之一，其基本思想是利用客户访问的时间局部性（Temproral Locality）原理，将客户访问过的内容在Cache中存放一个副本，当该内容下次被访问时，不必连接到驻留网站，而是由Cache中保留的副本提供。
		- Web内容可以缓存在客户端、代理服务器以及服务器端。研究表明，缓存技术可以显著地提高WWW性能，它可以带来以下好处：
			1、减少网络流量，从而减轻拥塞。
			2、降低客户访问延迟，其主要原因有：
				- 缓存在代理服务器中的内容，客户可以直接从代理获取而不是从远程服务器获取，从而减小了传输延迟；
				- 没有被缓存的内容由于网络拥塞及服务器负载的减轻而可以较快地被客户获取。
			3、由于客户的部分请求内容可以从代理处获取，从而减轻了远程服务器负载。
			4、如果由于远程服务器故障或者网络故障造成远程服务器无法响应客户的请求，客户可以从代理中获取缓存的内容副本，使得WWW服务的鲁棒性得到了加强。

		- Web缓存系统也会带来以下问题：
			- 数据信息的有效性问题：
				- 客户通过代理获取的可能是过时的内容。
			- 缓存失效问题：
				如果发生缓存失效，客户的访问延迟由于额外的代理处理开销而增加。因此在设计Web缓存系统时，应力求做到Cache命中率最大化和- 失效代价最小化。
			- 代理可能成为瓶颈：
				- 因此应为一个代理设定一个服务客户数量上限及一个服务效率下限，使得一个代理系统的效率至少同客户直接和远程服务器相连的效率一样。

	- 分布式缓存：
		目的：解决数据库服务器和web服务器之间的瓶颈。
			- 如果一个网站的流量很大，这个瓶颈将会非常明显，每次数据库查询耗费的时间将会非常可观。对于更新速度不是很快的网站，我们可以用静态化来避免过多的数据库查询。对于更新速度以秒计的网站，静态化也不会太理想，可以用缓存系统来构建。如果只是单台服务器用作缓存，问题不会太复杂，如果有多台服务器用作缓存，就要考虑缓存服务器的负载均衡。
		- 使用Memcached分布式缓存服务来达到保存用户的会话数据，而达到各个功能模块都能够跨省份、跨服务器共享本次会话中的私有数据的目的。每个省份使用一台服务器来做为Memcached服务器来存储用话的会话中的数据，当然也可以多台服务器，但必须确保每个省份的做Memcached服务器数量必须一致，这样才能够保证Memcached客户端操作的是同一份数据，保证数据的一致性。


## 缓存更新
	- 更新数据源：
		数据库、远程服务。
	- 更新的方式：
		- 主动更新。
			- 数据源是 DB 时，可以在更新完 DB 后就直接更新缓存。
		- 失效更新：
			- 当数据源不是 DB 而是其他远程服务，可能无法及时主动感知数据变更，这种情况下一般会选择对缓存数据设置失效期，也就是数据不一致的最大容忍时间，这种场景下，可以选择失效更新，key 不存在或失效时先请求数据源获取最新数据，然后再次缓存，并更新失效期。
			- 可能出现的问题：
				但这样做有个问题，如果依赖的远程服务在更新时出现异常，则会导致数据不可用。改进的办法是异步更新，就是当失效时先不清除数据，继续使用旧的数据，然后由异步线程去执行更新任务。这样就避免了失效瞬间的空窗期。另外还有一种纯异步更新方式，定时对数据进行分批更新。实际使用时可以根据业务场景选择更新方式。




	-